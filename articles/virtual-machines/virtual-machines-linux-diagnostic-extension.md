	<properties		pageTitle="using linux diagnostic extension to monitor linux vm’s performance and diagnostic data"		description="Learn how to linux diagnostic extension to monitor linux vm’s performance and diagnostic data."		services="virtual-machines"		documentationCenter=""    	authors="Ning"		manager="timlt"		editor=""    	tags=""/>	<tags		ms.service="virtual-machines"		ms.workload="infrastructure-services"		ms.tgt_pltfrm="vm-linux"		ms.devlang="na"		ms.topic="article"		ms.date="06/04/2015"		ms.author="Ning"/>#Uso de la extensión de diagnóstico de Linux para supervisar los datos de rendimiento y diagnóstico de la máquina virtual Linux##Introducción La extensión de diagnóstico de Linux ayuda al usuario a supervisar las máquinas virtuales Linux que se ejecutan en Azure, con las siguientes funcionalidades:1.	Recopila y carga los datos de rendimiento del sistema, diagnóstico y registro del sistema de la máquina virtual Linux en la tabla de almacenamiento del usuario.2.	Permite al usuario personalizar las métricas de datos que se recopilan y se cargan.	3.	Permite que el usuario cargar los archivos de registro especificados en la tabla de almacenamiento designada.Para la versión 2.0, los datos incluyen:1.	Todos los registros de Linux Rsyslog, incluidos los registros del sistema, seguridad y aplicaciones.2.	Todos los datos de sistema especificados en este [documento](https://scx.codeplex.com/wikipage?title=xplatproviders&referringTitle=Documentation "documento").3.	Archivos de registro especificados por el usuario.##Habilitación de la extensión La extensión puede habilitarse a través del Portal de administración de Azure, Azure PowerShell o scripts de la CLI de Azure.Para ver y configurar los datos de rendimiento y el sistema directamente desde el [Portal de administración de Azure](https://ms.portal.azure.com/#), siga estos [pasos](http://azure.microsoft.com/blog/2014/09/02/windows-azure-virtual-machine-monitoring-with-wad-extension/ "URL del blog de Windows"). Este artículo se centrará en habilitar y configurar la extensión mediante comandos de la CLI de Azure. Esto permite leer y ver los datos de la tabla de almacenamiento directamente.##Requisitos previos1. Agente Linux de Microsoft Azure versión 2.0.6 o posterior. Tenga en cuenta que la mayoría de las imágenes de la galería de máquina virtual Linux de Azure se incluyen en la versión 2.0.6. Puede ejecutar WAAgent -version para confirmar la versión instalada en la máquina virtual. Si la máquina virtual está ejecutando una versión anterior a 2.0.6, puede seguir estas [instrucciones](https://github.com/Azure/WALinuxAgent "instrucciones") para actualizarla.2.  [CLI de Azure](./xplat-cli.md "Azure CLI") Siga [esta guía](./xplat-cli-install.md "esta guía") para configurar el entorno de la CLI de Azure en su equipo. Una vez instalada la CLI de Azure, podrá utilizar el comando azure desde la interfaz de línea de comandos (Bash, Terminal, símbolo del sistema) para obtener acceso a los comandos de la CLI de Azure; por ejemplo, ejecute ‘azure vm extension set --help’ para un uso detallado, ejecute ‘azure login’ para iniciar sesión en Azure, ejecute ‘azure vm list’ para mostrar una lista de todas las máquinas virtuales que tiene en Azure.3. Cuenta de almacenamiento para almacenar los datos. Necesitará un nombre de la cuenta de almacenamiento creada previamente y una clave de acceso para cargar los datos en el almacenamiento.##Utilice el comando de la CLI de Azure para habilitar la extensión de diagnóstico de Linux ###  Escenario 1. Habilitación de la extensión con el conjunto de datos predeterminadoPara la versión 2.0 y posteriores, los datos predeterminados que se recopilarán incluyen: 1. Todas la información de Rsyslog, incluidos los registros del sistema, seguridad y aplicaciones.  2. Un conjunto de datos del sistema base; tenga en cuenta que el conjunto de datos completo está descrito en este [documento](https://scx.codeplex.com/wikipage?title=xplatproviders&referringTitle=Documentation "documento"). Si desea habilitar datos adicionales, continúe con los pasos descritos en el escenario 2 y 3.Paso 1. Creación de un archivo llamado PrivateConfig.json con el siguiente contenido:	{     	"storageAccountName":"the storage account to receive data",     	"storageAccountKey":"the key of the account"	}Paso 2: Ejecute ‘azure vm extension set vm_name LinuxDiagnostic Microsoft.OSTCExtensions 2.* --private-config-path PrivateConfig.json’.###   Escenario 2. Personalización de la métrica del monitor de rendimiento  Si desea personalizar la tabla de los datos de diagnóstico y rendimiento, siga estos pasos.Paso 1. Cree un archivo denominado PrivateConfig.json con el siguiente contenido; especifique los datos concretos que desea recopilar.Para todos los proveedores y variables admitidos, consulte este [documento](https://scx.codeplex.com/wikipage?title=xplatproviders&referringTitle=Documentation "documento"). Puede tener varias consultas y almacenarlas en varias tablas anexando más consultas en el script.Tenga en cuenta que, de forma predeterminada, siempre se recopilarán los datos de Rsyslog.	{     	"storageAccountName":"storage account to receive data",     	"storageAccountKey":"key of the account",      	"perfCfg":[           	{"query":"SELECT PercentAvailableMemory, AvailableMemory, UsedMemory ,PercentUsedSwap FROM SCX_MemoryStatisticalInformation","table":"LinuxMemory"           	}             ]	}Paso 2: Ejecute ‘azure vm extension set vm_name LinuxDiagnostic Microsoft.OSTCExtensions 2.* --private-config-path PrivateConfig.json’###   Escenario 3. Carga de sus propios archivos de registroSi desea recopilar archivos de registro específicos y cargarlos en la cuenta de almacenamiento, siga estos pasos. Deberá especificar la ruta de acceso al archivo de registro y el nombre de la tabla en la que se almacenará el registro. Para tener varios archivos de registro puede agregar varias entradas de archivo o tabla al script.Paso 1. Creación de un archivo llamado PrivateConfig.json con el siguiente contenido:	{     	"storageAccountName":"the storage account to receive data",     	"storageAccountKey":"key of the account",      	"fileCfg":[           	{"file":"/var/log/mysql.err",             "table":"mysqlerr"           	}           ]	}Paso 2: Ejecute ‘azure vm extension set vm_name LinuxDiagnostic Microsoft.OSTCExtensions 2.* --private-config-path PrivateConfig.json’###   Escenario 4. Deshabilitación de la extensión de diagnóstico de LinuxPaso 1. Creación de un archivo llamado PrivateConfig.json con el siguiente contenido:	{     	"storageAccountName":"the storage account to receive data",     	"storageAccountKey":"the key of the account",     	“perfCfg”:[],     	“enableSyslog”:”False”	}Paso 2: Ejecute ‘azure vm extension set vm_name LinuxDiagnostic Microsoft.OSTCExtensions 2.* --private-config-path PrivateConfig.json’##Revisión de los datosEl rendimiento y los datos de diagnóstico se almacenan en la tabla de almacenamiento de Azure; consulte [este artículo](./storage-ruby-how-to-use-table-storage.md "este artículo") sobre cómo obtener acceso a los datos en la tabla de almacenamiento mediante scripts de la CLI de Azure.Además, puede utilizar las siguientes herramientas de la interfaz de usuario para tener acceso a los datos:1.	Utilice el Explorador de servidores de Visual Studio. Vaya a la cuenta de almacenamiento. Después de que la máquina virtual se ha ejecutado aproximadamente cinco minutos, debería ver las tablas predeterminadas. “LinuxCpu”, ”LinuxDisk”, ”LinuxMemory”, ”Linuxsyslog”. Haga doble clic en el nombre de la tabla para ver los datos. 2.	Utilice [Explorador de almacenamiento de Azure](https://azurestorageexplorer.codeplex.com/ "Explorador de almacenamiento de Azure") para tener acceso a los datos. ![imagen](./media/virtual-machines-linux-diagnostic-extension/no1.png)Si ha habilitado el archivo fileCfg o perfCfg especificado en los escenarios 2 y 3, también podrá ver los datos no predeterminados desde las herramientas anteriores.##Problemas conocidos1. En la versión 2.0, solo puede tener acceso a la información de Rsyslog y el archivo de registro del cliente especificado a través de scripts.2. En la versión 2.0, si ha habilitado la extensión de diagnóstico de Linux mediante un script en primer lugar, después no podrá ver los datos desde el portal. Por otro lado, si habilita primero la extensión desde el portal, los scripts seguirán funcionando.Esperamos solucionar ambos problemas en la próxima versión. 

<!---HONumber=July15_HO2-->